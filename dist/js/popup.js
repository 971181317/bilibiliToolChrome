(()=>{"use strict";var e={399:(e,i,t)=>{t.r(i)},266:(e,i)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.http=void 0,i.http={httpGet:async e=>fetch(e,{method:"get",headers:{"content-type":"application/json"},credentials:"include"}),httpPost:async(e,i)=>fetch(e,{method:"post",body:i,credentials:"include",headers:{"content-type":"application/json"}})}},27:(e,i,t)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.extensionOperation=i.getCurrentTab=i.setConfig=i.getConfig=i.defaultConfig=void 0;const n=t(266),a=t(597);async function r(){let e=await chrome.storage.sync.get(["chromeConfig"]);return null==e.chromeConfig?i.defaultConfig:JSON.parse(e.chromeConfig)}function c(e){chrome.storage.sync.set({chromeConfig:JSON.stringify(e)})}i.defaultConfig={isDark:!1,contextMenu:!0,popupSearch:!0,videoImg:!0,signIn:!0,signinAlarm:!1,easyDark:!1},i.getConfig=r,i.setConfig=c,i.getCurrentTab=async function(){let[e]=await chrome.tabs.query({active:!0,currentWindow:!0});return e},i.extensionOperation={userBilibiliInterfaceOnPage:async(e,i)=>{if(i.url.indexOf("bilibili.com")>-1&&e.signIn){let e=await chrome.cookies.get({url:"https://www.bilibili.com",name:"SESSDATA"}),t=await chrome.cookies.get({url:"https://www.bilibili.com",name:"bili_jct"});await chrome.scripting.executeScript({target:{tabId:i.id},func:a.script.doUserBilibiliInterface,args:[e.value,t.value]})}},dark:async(e,i)=>{i.url.indexOf("bilibili.com")>-1&&e.isDark&&await chrome.scripting.insertCSS({files:["dist/css/bilibili_dark_inject.css"],target:{tabId:i.id}})},video:async(e,i)=>{i.url.indexOf("bilibili.com/video")>-1&&e.videoImg&&await chrome.scripting.executeScript({target:{tabId:i.id},func:a.script.doBilibiliGetImg})},signIn:async()=>{let e=await r();if(!e.signinAlarm&&e.signIn){let e={type:"basic",iconUrl:"../../img/favicon128-128.png",title:"bilibili小插件 by淺い空",message:"已完成B站每日签到！！"};if(null==await chrome.cookies.get({url:"https://www.bilibili.com",name:"SESSDATA"}))e.message="没有登录b站，登陆后才可以使用每日签到哦！！";else{let t=await n.http.httpGet("https://www.bilibili.com"),a=await n.http.httpGet("https://api.live.bilibili.com/xlive/web-ucenter/v1/sign/DoSign");if(t.status>399||a.status>399)e.message="网络错误，每日签到失败了啊！！";else{let e=(new Date).getTime(),t=e-(e+288e5)%864e5+864e5;chrome.alarms.create("signIn",{delayInMinutes:(t-e)/1e3/60});let n=await r();n.signinAlarm=!0,c(n),chrome.alarms.onAlarm.addListener((async e=>{"signIn"==e.name&&await i.extensionOperation.signIn()}))}}chrome.notifications.create(null,e)}}}},597:(e,i)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.script=void 0,i.script={doUserBilibiliInterface:(e,i)=>window.userBilibiliInterface(e,i),doBilibiliGetImg:()=>window.bilibiliGetImg()}}},i={};function t(n){var a=i[n];if(void 0!==a)return a.exports;var r=i[n]={exports:{}};return e[n](r,r.exports,t),r.exports}t.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},(()=>{t(399);const e=t(27);async function i(){let i=await(0,e.getConfig)();"开启夜间模式"==$("#darkBtn").text()?(i.isDark=!0,$("#darkBtn").text("关闭夜间模式")):(i.isDark=!1,$("#darkBtn").text("开启夜间模式")),(0,e.setConfig)(i)}async function n(){chrome.tabs.create({url:"https://search.bilibili.com/all?keyword="+$("input").val()+"&from_source=nav_suggest_new",active:!0,index:(await(0,e.getCurrentTab)()).index+1})}async function a(){chrome.tabs.create({url:"https://www.bilibili.com",active:!0,index:(await(0,e.getCurrentTab)()).index+1})}async function r(){chrome.tabs.create({url:"dist/page/setting.html",active:!0,index:(await(0,e.getCurrentTab)()).index+1})}!async function(){let t=await(0,e.getConfig)();t.isDark?$("#darkBtn").text("关闭夜间模式"):$("#darkBtn").text("开启夜间模式"),t.popupSearch||($("input").attr("hidden","hidden"),$("#searchBtn").css("display","none")),$("#darkBtn").click(i),$("#indexPage").click(a),$("#searchBtn").click(n),$("#setting").click(r)}()})()})();