(()=>{"use strict";var e={858:(e,t,i)=>{i.r(t)},399:(e,t,i)=>{i.r(t)},266:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.http=void 0,t.http={httpGet:async e=>fetch(e,{method:"get",headers:{"content-type":"application/json"},credentials:"include"}),httpPost:async(e,t)=>fetch(e,{method:"post",body:t,credentials:"include",headers:{"content-type":"application/json"}})}},631:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.honeySwitch=void 0,t.honeySwitch={themeColor:"rgb(2,157,208)",init:function(){$("[switch]").append("<span class='slider'></span>")},showOn:function(e){if($(e).removeClass("switch-off").addClass("switch-on"),t.honeySwitch.themeColor){var i=t.honeySwitch.themeColor;$(e).css({"border-color":i,"box-shadow":i+" 0px 0px 0px 16px inset","background-color":i})}},showOff:function(e){$(e).removeClass("switch-on").addClass("switch-off"),$(".switch-off").css({"border-color":"#dfdfdf","box-shadow":"rgb(223, 223, 223) 0px 0px 0px 0px inset","background-color":"rgb(255, 255, 255)"})}}},27:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.extensionOperation=t.getCurrentTab=t.setConfig=t.getConfig=t.defaultConfig=void 0;const n=i(266),o=i(597);async function s(){let e=await chrome.storage.sync.get(["chromeConfig"]);return null==e.chromeConfig?t.defaultConfig:JSON.parse(e.chromeConfig)}function a(e){chrome.storage.sync.set({chromeConfig:JSON.stringify(e)})}t.defaultConfig={isDark:!1,contextMenu:!0,popupSearch:!0,videoImg:!0,signIn:!0,signinAlarm:!1,easyDark:!1},t.getConfig=s,t.setConfig=a,t.getCurrentTab=async function(){let[e]=await chrome.tabs.query({active:!0,currentWindow:!0});return e},t.extensionOperation={userBilibiliInterfaceOnPage:async(e,t)=>{if(t.url.indexOf("bilibili.com")>-1&&e.signIn){let e=await chrome.cookies.get({url:"https://www.bilibili.com",name:"SESSDATA"}),i=await chrome.cookies.get({url:"https://www.bilibili.com",name:"bili_jct"});await chrome.scripting.executeScript({target:{tabId:t.id},func:o.script.doUserBilibiliInterface,args:[e.value,i.value]})}},dark:async(e,t)=>{t.url.indexOf("bilibili.com")>-1&&e.isDark&&await chrome.scripting.insertCSS({files:["dist/css/bilibili_dark_inject.css"],target:{tabId:t.id}})},video:async(e,t)=>{t.url.indexOf("bilibili.com/video")>-1&&e.videoImg&&await chrome.scripting.executeScript({target:{tabId:t.id},func:o.script.doBilibiliGetImg})},signIn:async()=>{let e=await s();if(!e.signinAlarm&&e.signIn){let e={type:"basic",iconUrl:"../../img/favicon128-128.png",title:"bilibili小插件 by淺い空",message:"已完成B站每日签到！！"};if(null==await chrome.cookies.get({url:"https://www.bilibili.com",name:"SESSDATA"}))e.message="没有登录b站，登陆后才可以使用每日签到哦！！";else{let i=await n.http.httpGet("https://www.bilibili.com"),o=await n.http.httpGet("https://api.live.bilibili.com/xlive/web-ucenter/v1/sign/DoSign");if(i.status>399||o.status>399)e.message="网络错误，每日签到失败了啊！！";else{let e=(new Date).getTime(),i=e-(e+288e5)%864e5+864e5;chrome.alarms.create("signIn",{delayInMinutes:(i-e)/1e3/60});let n=await s();n.signinAlarm=!0,a(n),chrome.alarms.onAlarm.addListener((async e=>{"signIn"==e.name&&await t.extensionOperation.signIn()}))}}chrome.notifications.create(null,e)}}}},597:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.script=void 0,t.script={doUserBilibiliInterface:(e,t)=>window.userBilibiliInterface(e,t),doBilibiliGetImg:()=>window.bilibiliGetImg()}}},t={};function i(n){var o=t[n];if(void 0!==o)return o.exports;var s=t[n]={exports:{}};return e[n](s,s.exports,i),s.exports}i.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},(()=>{i(399),i(858);const e=i(631),t=i(27);function n(t,i,n){$(t).click((function(){if(!$(this).hasClass("switch-disabled"))if($(this).hasClass("switch-on"))$(this).removeClass("switch-on").addClass("switch-off"),$(".switch-off").css({"border-color":"#dfdfdf","box-shadow":"rgb(223, 223, 223) 0px 0px 0px 0px inset","background-color":"rgb(255, 255, 255)"}),"function"==typeof n&&n();else{if($(this).removeClass("switch-off").addClass("switch-on"),e.honeySwitch.themeColor){var t=e.honeySwitch.themeColor;$(this).css({"border-color":t,"box-shadow":t+" 0px 0px 0px 16px inset","background-color":t})}"function"==typeof i&&i()}}))}e.honeySwitch.init(),async function(){let i=await(0,t.getConfig)();i.popupSearch?e.honeySwitch.showOn($("#popupSearchBtn")):e.honeySwitch.showOff($("#popupSearchBtn")),i.contextMenu?e.honeySwitch.showOn($("#contextMenuSearchBtn")):e.honeySwitch.showOff($("#contextMenuSearchBtn")),i.isDark?e.honeySwitch.showOn($("#darkBtn")):e.honeySwitch.showOff($("#darkBtn")),i.videoImg?e.honeySwitch.showOn($("#getImg")):e.honeySwitch.showOff($("#getImg")),i.omnibox?e.honeySwitch.showOn($("#omniboxSearchBtn")):e.honeySwitch.showOff($("#omniboxSearchBtn")),i.signIn?e.honeySwitch.showOn($("#signInBtn")):e.honeySwitch.showOff($("#signInBtn")),i.easyDark?e.honeySwitch.showOn($("#easyDarkBtn")):e.honeySwitch.showOff($("#easyDarkBtn"))}(),n("#popupSearchBtn",(async function(){let e=await(0,t.getConfig)();e.popupSearch=!0,(0,t.setConfig)(e)}),(async function(){let e=await(0,t.getConfig)();e.popupSearch=!1,(0,t.setConfig)(e)})),n("#contextMenuSearchBtn",(async function(){let e=await(0,t.getConfig)();e.contextMenu=!0,(0,t.setConfig)(e)}),(async function(){let e=await(0,t.getConfig)();e.contextMenu=!1,(0,t.setConfig)(e)})),n("#darkBtn",(async function(){let e=await(0,t.getConfig)();e.isDark=!0,(0,t.setConfig)(e)}),(async function(){let e=await(0,t.getConfig)();e.isDark=!1,(0,t.setConfig)(e)})),async function(){n("#getImg",(async function(){let e=await(0,t.getConfig)();e.videoImg=!0,(0,t.setConfig)(e)}),(async function(){let e=await(0,t.getConfig)();e.videoImg=!1,(0,t.setConfig)(e)}))}(),n("#signInBtn",(async function(){let e=await(0,t.getConfig)();e.signIn=!0,(0,t.setConfig)(e),await t.extensionOperation.signIn()}),(async function(){let e=await(0,t.getConfig)();e.signIn=!1,e.signinAlarm=!1,chrome.alarms.clear("signIn"),(0,t.setConfig)(e)})),n("#easyDarkBtn",(async function(){let e=await(0,t.getConfig)();e.easyDark=!0,(0,t.setConfig)(e)}),(async function(){let e=await(0,t.getConfig)();e.easyDark=!1,(0,t.setConfig)(e)}))})()})();